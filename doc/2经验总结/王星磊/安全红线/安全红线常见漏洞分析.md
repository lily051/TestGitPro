###常见漏洞处理

####AppScan扫描
#####SQL盲注
	
	原因：
	dao层和数据库交互的SQL语句中使用了字符串拼接，造成SQL注入
	
	解决方案：
	检查所有dao层实现类，保证所有的SQL语句中都去除了字符串拼接，使用占位符的形式来插入变量

#####HTTP.sys远程代码执行
	
	主要体现为HTTP 416错误
	本地Eclipse运行程序的时候会出现这种问题，可以打成war包放在服务狗中运行，再次扫描，该问题基本就不再出现了
	如果还有该问题，可以将程序中的jetty插件移除

#####跨站点脚本编制

	主要体现为HIK_COOKIE_STYLE
	全局搜索HIK_COOKIE_STYLE，去除jsp页面和后台java代码中关于HIK_COOKIE_STYLE的代码

	<%
		String style =StringUtils.defaultIfBlank(CookieUtil.getCookieValue(request, "HIK_COOKIE_STYLE"), "default"); 
	    if(!StringUtils.equals(style, "default")){ 
	%> 
		<link href="${ctx}/baseui/themes/<%=style %>/css/base.css" rel="stylesheet"/> 
	<%
		} 
	%> 

	CookieUtil.setCookie(getResponse(), "HIK_COOKIE_STYLE", StringUtils.defaultIfBlank("", "default"),30 * 24 * 60 * 60, "/", null);
#####查询中的密码参数
	
	体现为passwordLevel，系误报

#####DNewsWeb 缓冲区溢出和远程命令执行

	同安全实验室确认，系误报

#####Finger Server CGI Shell命令执行
	理财和车载暂未出现

#####George Buryan Counter CGI远程命令执行
	理财和车载暂未出现

#####PHF CGI远程命令执行
	理财和车载暂未出现

#####Postaci WebMail SQL查询修改
	理财和车载暂未出现

#####已解密的登录请求
	理财和车载暂未出现
	经确认，系误报【具体问题具体分析】

#####主机允许从任何域进行flash访问
	理财和车载暂未出现


----------

####WVS 扫描漏洞

#####HTTP 900

	进入首页时，不能直接调用后台action层的方法
	如下方法不可取

	<%
	response.sendRedirect(request.getContextPath() + "/web/index.action");
	%>
	

----------

####Web平台安全自动化检测
#####视频编码网关弱密码检测
	车载的漏洞
	VAG服务弱密码，暂不处理

#####MySQL数据库端口检测
	MySQL port3306 is open密码未破解
	3306端口对外暴漏
	在my.ini中添加bind-address=127.0.0.1配置项

----------

####Nessus 扫描漏洞
#####PHP高危漏洞 

	4个PHP高危漏洞
	58987 PHP Unsupported Version Detection
	76281 PHP 5.4.x < 5.4.30 Multiple Vulnerabilities
	83033 PHP 5.4.x < 5.4.40 Multiple Vulnerabilities
	85885 PHP 5.4.x < 5.4.45 Multiple Vulnerabilities

	VAG的web程序的漏洞
	可和【胡星】沟通，升级VAG服务，或不处理

----------

####绿盟 扫描漏洞
##### 服务器支持 TLS Client-initiated 重协商攻击
	17866 TSMSupply.exe进程占用 不是系统的服务端口
##### WWW服务器畸形HTTP方式413错误页面跨站脚本漏洞
	漏洞端口：7288 8008
	7288 VAG和web交互端口
 	8088 文件服务数据端
##### SSL 3.0 POODLE攻击信息泄露漏洞(CVE-2014-3566)
	17866 TSMSupply.exe进程占用 不是系统的服务端口
##### SSL/TLS 受诫礼(BAR-MITZVAH)攻击漏洞(CVE-2015-2808)
	8089 文件服务端口 pss.exe进程占用
	17866 TSMSupply.exe进程占用 不是系统的服务端口
##### OpenSSL "SSL-Death-Alert" 拒绝服务漏洞(CVE-2016-8610)
	8089 文件服务端口 pss.exe进程占用
	17866 TSMSupply.exe进程占用 不是系统的服务端口
	
**说明**
	
	测试的时候最好让测试在干净的服务器上进行部署测试，不要在本地环境
	本地环境有公司的防火墙，会有很多莫名的漏洞出现，如17866端口就属于公司的杀毒软件的端口

----------

####多引擎病毒扫描
#####Nod32 特洛伊木马变种
	DLSDK.dll可能是特洛伊木马的变种
	删除事件服务下的FSvcEvent\help\ProtocolTransAlarmDemo文件夹

----------

####目录浏览离线工具
#####SYS-VUL-0048漏洞
	java反序列检测到不安全的jar包
	解决方法：更新commons-collections到3.2.2版本

####SYS-VUL-0041漏洞
	web.xml中未配置session的失效时间
	一般都是配置在system.properties中的，系误报

