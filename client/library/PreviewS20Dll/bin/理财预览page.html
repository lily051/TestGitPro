<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script>
function startplay()
{
	// var xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Param><RecordType>255</RecordType><SearchType>0</SearchType><WndNo>-1</WndNo><PlayType>5</PlayType><DvrType>100</DvrType><Right>255</Right><LoginInfo><IP>10.64.60.80</IP><Port>8008</Port><User>web_admin</User><Password>123</Password><Rev>10.64.56.36_0_0</Rev></LoginInfo><PlayInfo><CamID>1001</CamID><CamName>9116</CamName><Channel>0</Channel><StartTime>2013-03-01 00:00:00</StartTime><StopTime>2013-03-07 23:12:12</StopTime><Rev>999</Rev></PlayInfo></Param>";
	var xml1 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Preview><CamType>0</CamType><CamID>1</CamID><CamName>101_02</CamName><DevType>0</DevType><RegionID>2</RegionID><DevIP>10.16.37.105</DevIP><DevPort>8000</DevPort><User>admin</User><Pwd>12345</Pwd><Channel>32</Channel><RealPlayType>0</RealPlayType><VideoFormat>0</VideoFormat><CamRight></CamRight><StreamIP></StreamIP><StreamPort>9557</StreamPort><Protocol>0</Protocol><UserID>3</UserID><CollectorIP>10.64.56.212</CollectorIP><PhonePort>9527</PhonePort><VedioPort>9537</VedioPort><TimeOut>45</TimeOut><DelayTime>15</DelayTime></Preview>";
	var xml2 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><BussInfo><OSDNum>4</OSDNum><Node>案件号:10215410</Node><Node>业务流水号：123123</Node><Node>业务类型：结算类</Node><Node>客户姓名：张三</Node><Node>客户证件号：9527</Node><Node>录单区域杭州支行</Node><Node>业务员工号：001</Node><Node>业务时间：2015-07-24 19:25:36</Node></BussInfo>";
	var xml3 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><CfgData><Path>C:\\8120\\</Path><MaxRecSize>2</MaxRecSize><PicType>0</PicType></CfgData>";
	document.getElementById("ocx").StartPreview(xml1);
	document.getElementById("ocx").SetShowString(xml2);
	document.getElementById("ocx").SetConfigData(xml3);
}
function stopplay()
{	
	document.getElementById("ocx").StopPreview(0);
}
function startrecord()
{
	document.getElementById("ocx").StartRecord(0);
}
function stoprecord()
{
	var xml;
//	document.getElementById("ocx").StopRecordByWndNum(0);
	xml = document.getElementById("ocx").StopRecord(0);
}

function enablerecord()
{
	//var xml = "禁止录像";
   // document.getElementById("ocx").EnableRecordEx(0,xml);
	//document.getElementById("ocx").EnableRecord(0);
	var xml = document.getElementById("ocx").GetAllUSBCameraInfo();
	alert(xml);
}

function startusbplay()
{
	// var xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Param><RecordType>255</RecordType><SearchType>0</SearchType><WndNo>-1</WndNo><PlayType>5</PlayType><DvrType>100</DvrType><Right>255</Right><LoginInfo><IP>10.64.60.80</IP><Port>8008</Port><User>web_admin</User><Password>123</Password><Rev>10.64.56.36_0_0</Rev></LoginInfo><PlayInfo><CamID>1001</CamID><CamName>9116</CamName><Channel>0</Channel><StartTime>2013-03-01 00:00:00</StartTime><StopTime>2013-03-07 23:12:12</StopTime><Rev>999</Rev></PlayInfo></Param>";
	var xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Preview><CamType>2</CamType><CamIndex>0</CamIndex><CamName>CamName</CamName><MicIndex>0</MicIndex><MicName>MicName</MicName><TimeOut>45</TimeOut></Preview>";
	var xml2 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><CfgData><Path>C:\\8120\\</Path><MaxRecSize>1</MaxRecSize><PicType>0</PicType></CfgData>";
	document.getElementById("ocx").StartPreview(xml);
	document.getElementById("ocx").SetConfigData(xml2);
}
function stopusbplay()
{	
	document.getElementById("ocx").StopPreview(0);
}
function startusbrecord()
{
	document.getElementById("ocx").StartRecord(0);
}
function stopusbrecord()
{
    var xml;
	xml = document.getElementById("ocx").StopRecord(0);
}

function init()
{
	var xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Param><PicPath>c:\\lala2\\</PicPath><DownloadPath>c:\\lala2\\</DownloadPath><PicType>1</PicType><ShowTitle>1</ShowTitle></Param>";

	//document.getElementById("ocx").PB_SetParam(xml);
}
</script>

<script language="javascript" type="text/javascript" for=ocx event="RecordFile(lpstrXML)">
    alert(lpstrXML);
</script>

<script language="javascript" type="text/javascript" for=ocx event="OnWriteLog(lpstrXML)">
    alert(lpstrXML);
</script>
<script language="javascript" type="text/javascript" for=ocx event="OnFileInfo(lpstrXML)">
    alert(lpstrXML);
</script>
<script language="javascript" for=ocx event="FireIDCardInfo(name, cardno, birthday ,sex, nation, address,begindate,enddate,government)">  //切换窗口触发事件
	var str;
	str = "姓名:" + name + "\r\n";
	str = str + "身份证号:" + cardno + "\r\n";
	str = str + "出生日期:" + birthday + "\r\n";
	str = str + "性别:" + sex + "\r\n";
	str = str + "民族:" + nation + "\r\n";
	str = str + "住址:" + address + "\r\n";
	str = str + "有效期开始日期:" + begindate + "\r\n";
	str = str + "有效期结束日期:" + enddate + "\r\n";
	str = str + "签发机关:" + government + "\r\n";
	alert(str);
</script>
</head>

<body onload="init()">
<table>
<tr>
  <td>
    <tr>
		<td>
			<input type="button" value="开始预览" onclick="startplay()" />
		</td>
		<td>
			<input type="button" value="停止预览" onclick="stopplay()" />
		</td>
		<<td>
			<input type="button" value="开始录像" onclick="startrecord()" />
		</td>
		<td>
			<input type="button" value="停止录像" onclick="stoprecord()" />
		</td>
		<td>
			<input type="button" value="禁止录像" onclick="enablerecord()" />
		</td>
		<td>
			<input type="button" value="开始USB预览" onclick="startusbplay()" />
		</td>
		<td>
			<input type="button" value="停止USB预览" onclick="stopusbplay()" />
		</td>
		<<td>
			<input type="button" value="开始USB录像" onclick="startusbrecord()" />
		</td>
		<td>
			<input type="button" value="停止USB录像" onclick="stopusbrecord()" />
		</td>

	</tr>
  </td>
</tr>
</table>
<table>
<tr>
		<td>
			<OBJECT ID="ocx" CLASSID="CLSID:04655FF8-9979-4FFA-8F77-C3A539EA7370", width="800", height="500">
				<param name="lLayoutMode" value="0" />
				<param name="lSkinType" value="0" />
			</OBJECT>
		</td>
	</tr>
</table>
</body>
</html>
